<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOEIC LIAM - Earn & Learn</title>
    <!-- React & Tailwind -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Firebase SDKs (Compat Version) -->
    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f0f4f8; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #e2e8f0; }
        ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        .rotate-y-0 { transform: rotateY(0deg); }
        .card-face {
            position: absolute; width: 100%; height: 100%;
            backface-visibility: hidden; border-radius: 0.75rem;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .animate-fadeIn { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes popIn { 0% { transform: scale(0); opacity: 0; } 80% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); } }
        .animate-popIn { animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        .animate-shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        
        @keyframes coinUp {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-50px) scale(1.5); }
        }
        .coin-float { animation: coinUp 0.8s ease-out forwards; pointer-events: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- 1. CẤU HÌNH FIREBASE ---
        const firebaseConfigManual = {
            apiKey: "AIzaSyCM_gVrI8Yfg-eghdzMT5aIKx_vh9eNavc",
            authDomain: "toeic-game.firebaseapp.com",
            projectId: "toeic-game",
            storageBucket: "toeic-game.firebasestorage.app",
            messagingSenderId: "256652471234",
            appId: "1:256652471234:web:227e24e34cd391a1fec45b",
            measurementId: "G-4TTN534GNR"
        };

        let firebaseConfig;
        if (typeof __firebase_config !== 'undefined') {
            try { firebaseConfig = JSON.parse(__firebase_config); } catch (e) { firebaseConfig = firebaseConfigManual; }
        } else { firebaseConfig = firebaseConfigManual; }
        
        if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
        
        const app = firebase.apps.length ? firebase.app() : null;
        const auth = app ? firebase.auth() : null;
        const db = app ? firebase.firestore() : null;
        const googleProvider = auth ? new firebase.auth.GoogleAuthProvider() : null;
        
        const appId = 'toeic-master-live-v1';

        // --- DATA ---
        const rawDataString = `
Contracts|Abide by|/ə'baid/|Tuân thủ, tuân theo (quy định, điều khoản)|Parties must abide by the terms.|Follow, Obey|Violate
Contracts|Agreement|/ə'gri:mənt/|Hợp đồng, thỏa thuận giữa các bên|Signed the agreement.|Contract, Deal|Disagreement
Contracts|Agree|/ə'gri:/|Đồng ý, tán thành với ý kiến hoặc đề xuất|I agree with the plan.|Consent, Concur|Disagree
Contracts|Assurance|/ə'ʃuərəns/|Sự đảm bảo, cam kết chắc chắn về điều gì đó|Gave assurance of quality.|Guarantee, Pledge|Doubt
Contracts|Cancellation|/,kænse'leiʃn/|Sự hủy bỏ (hợp đồng, đơn hàng)|Flight cancellation.|Annulment|Confirmation
Contracts|Determine|/di'tə:min/|Quyết định, xác định rõ ràng điều gì đó|Determine the cause.|Decide, Ascertain|Hesitate
Contracts|Engage|/in'geidʤ/|Tham gia, cam kết vào một hoạt động hoặc hợp đồng|Engage in business.|Participate|Withdraw
Contracts|Establish|/is'tæbliʃ/|Thiết lập, thành lập (công ty, quy định)|Establish a company.|Set up, Found|Destroy
Contracts|Obligate|/'ɔbligeit/|Bắt buộc, ràng buộc về mặt pháp lý hoặc đạo đức|Legally obligated.|Compel, Force|Free
Contracts|Party|/'pɑ:ti/|Bên (tham gia trong hợp đồng hoặc thỏa thuận)|Both parties agreed.|Side, Faction|N/A
Contracts|Provision|/prə'viʒn/|Điều khoản, quy định cụ thể trong hợp đồng|Contract provision.|Clause, Stipulation|Removal
Contracts|Resolve|/ri'zɔlv/|Giải quyết, tìm ra giải pháp cho vấn đề|Resolve the issue.|Solve, Settle|Complicate
Contracts|Specific|/spi'sifik/|Cụ thể, rõ ràng, riêng biệt|Specific instructions.|Particular, Precise|General
Marketing|Attract|/ə'trækt/|Thu hút, lôi cuốn (khách hàng, sự chú ý)|Attract customers.|Lure, Draw|Repel
Marketing|Compare|/kəm'peə/|So sánh để tìm điểm khác biệt hoặc giống nhau|Compare prices.|Contrast|Ignore
Marketing|Competition|/,kɔmpi'tiʃn/|Sự cạnh tranh giữa các doanh nghiệp|Market competition.|Rivalry|Cooperation
Marketing|Consume|/kən'sju:m/|Tiêu thụ, sử dụng hết (sản phẩm, tài nguyên)|Consume energy.|Use, Devour|Produce
Marketing|Convince|/kən'vins/|Thuyết phục ai đó tin hoặc làm điều gì|Convince the client.|Persuade|Discourage
Marketing|Currently|/ˈkʌrəntli/|Hiện tại, vào thời điểm này|Currently unavailable.|Presently, Now|Formerly
Marketing|Fad|/fæd/|Mốt nhất thời, trào lưu tạm thời|Just a passing fad.|Trend, Craze|Tradition
Marketing|Inspiration|/,inspə'reiʃn/|Cảm hứng, nguồn động lực sáng tạo|Source of inspiration.|Motivation|Discouragement
Marketing|Market|/'mɑ:kit/|Thị trường; tiếp thị sản phẩm|Target market.|Trade, Sell|Buy
Marketing|Persuasion|/pə'sweiʤn/|Sự thuyết phục, khả năng làm người khác tin theo|Power of persuasion.|Influence|Force
Marketing|Productive|/prəˈdʌktɪv/|Có năng suất, hiệu quả cao|Productive meeting.|Efficient|Unproductive
Marketing|Satisfaction|/,sætis'fækʃn/|Sự hài lòng, thỏa mãn của khách hàng|Customer satisfaction.|Contentment|Dissatisfaction
Warranties|Characteristic|/,kæriktə'ristik/|Đặc điểm, đặc tính riêng biệt|Key characteristic.|Trait, Feature|Uncharacteristic
Warranties|Consequence|/'kɔnsikwəns/|Hậu quả, kết quả của một hành động|Face the consequences.|Result, Outcome|Cause
Warranties|Consider|/kən'sidə/|Cân nhắc, xem xét kỹ lưỡng|Consider the offer.|Think about|Ignore
Warranties|Cover|/'kʌvə/|Bao gồm, chi trả (trong bảo hành, bảo hiểm)|Warranty covers repairs.|Include, Insure|Exclude
Warranties|Expiration|/,ekspaiə'reiʃn/|Sự hết hạn, thời điểm kết thúc hiệu lực|Expiration date.|Termination|Start
Warranties|Frequently|/ˈfriːkwəntli/|Thường xuyên, xảy ra nhiều lần|Frequently asked.|Often|Rarely
Warranties|Imply|/im'plai/|Ngụ ý, ám chỉ một cách gián tiếp|Imply a threat.|Suggest|State
Warranties|Promise|/'prɔmis/|Lời hứa, cam đoan sẽ làm điều gì đó|Keep a promise.|Vow, Pledge|Deny
Warranties|Protect|/prə'tekt/|Bảo vệ, che chở khỏi nguy hiểm hoặc hư hại|Protect data.|Guard, Shield|Attack
Warranties|Reputation|/,repju:'teiʃn/|Danh tiếng, uy tín của cá nhân hoặc tổ chức|Good reputation.|Fame, Status|Infamy
Warranties|Require|/ri'kwaiə/|Yêu cầu, đòi hỏi phải có điều gì đó|Require assistance.|Need, Demand|Optional
Warranties|Variety|/və'raiəti/|Sự đa dạng, nhiều loại khác nhau|Variety of choices.|Diversity|Uniformity
Planning|Address|/ə'dres/|Giải quyết, xử lý (vấn đề); trình bày|Address the problem.|Deal with|Ignore
Planning|Avoid|/ə'vɔid/|Tránh, né tránh điều gì đó|Avoid mistakes.|Evade, Shun|Confront
Planning|Demonstrate|/'demənstreit/|Chứng minh, minh họa cách thức hoặc sự thật|Demonstrate how.|Show, Prove|Hide
Planning|Develop|/di'veləp/|Phát triển, cải thiện dần dần|Develop skills.|Grow, Evolve|Stagnate
Planning|Evaluate|/i'væljueit/|Đánh giá, xem xét giá trị hoặc chất lượng|Evaluate performance.|Assess, Judge|Neglect
Planning|Gather|/'gæðə/|Thu thập, tập hợp lại một nơi|Gather data.|Collect|Disperse
Planning|Offer|/'ɔfə/|Đề nghị, đưa ra (cơ hội, sản phẩm)|Make an offer.|Propose|Refuse
Planning|Primarily|/'praimərili/|Chủ yếu, trước hết về mặt quan trọng|Primarily responsible.|Mainly|Secondarily
Planning|Risk|/rɪsk/|Rủi ro, nguy cơ có thể xảy ra tổn thất|Financial risk.|Danger, Hazard|Safety
Planning|Strategy|/ˈstrætədʒi/|Chiến lược, kế hoạch dài hạn để đạt mục tiêu|Marketing strategy.|Plan, Tactic|Improvisation
Planning|Strong|/strɔɳ/|Mạnh mẽ, vững chắc, có ảnh hưởng lớn|Strong leadership.|Powerful|Weak
Planning|Substitution|/,sʌbsti'tju:ʃn/|Sự thay thế, việc dùng cái khác thay cho cái ban đầu|Product substitution.|Replacement|Retention
Conferences|Accommodate|/ə'kɔmədeit/|Cung cấp chỗ ở; đáp ứng nhu cầu|Accommodate guests.|House, Fit|Reject
Conferences|Arrangement|/ə'reindʤmənt/|Sự sắp xếp, chuẩn bị trước|Travel arrangement.|Preparation|Disorder
Conferences|Association|/ə,sousi'eiʃn/|Hiệp hội, tổ chức có mục đích chung|Trade association.|Organization|Separation
Conferences|Attend|/ə'tend/|Tham dự, có mặt tại sự kiện|Attend the conference.|Present at|Miss
Conferences|Get in touch|/tʌtʃ/|Liên lạc, liên hệ với ai đó|Get in touch soon.|Contact|Ignore
Conferences|Hold|/hould/|Tổ chức, giữ (sự kiện, cuộc họp)|Hold a meeting.|Conduct|Cancel
Conferences|Location|/lou'keiʃn/|Vị trí, địa điểm diễn ra sự kiện|Prime location.|Place, Site|N/A
Conferences|Overcrowded|/əʊvəˈkraʊdɪd/|Đông nghịt, quá tải người|Overcrowded room.|Congested|Empty
Conferences|Register|/'redʤistə/|Đăng ký tham gia chính thức|Register online.|Enroll, Sign up|Withdraw
Conferences|Select|/si'lekt/|Chọn lựa cẩn thận từ nhiều lựa chọn|Select a winner.|Choose, Pick|Reject
Conferences|Session|/'seʃn/|Phiên họp, buổi làm việc|Morning session.|Meeting|Break
Conferences|Take part in|/pɑ:t/|Tham gia, tham dự vào hoạt động|Take part in discussion.|Participate|Avoid
Computers|Access|/ˈækses/|Truy cập, quyền sử dụng hệ thống|Access denied.|Enter|Exit
Computers|Allocate|/ˈæləkeɪt/|Phân bổ, phân phối tài nguyên|Allocate memory.|Assign|Withhold
Computers|Compatible|/kəm'pætəbl/|Tương thích, có thể hoạt động cùng nhau|Compatible software.|Consistent|Incompatible
Computers|Delete|/di'li:t/|Xóa bỏ vĩnh viễn (dữ liệu, file)|Delete files.|Erase, Remove|Restore
Computers|Display|/dis'plei/|Hiển thị trên màn hình|Display screen.|Show, Exhibit|Hide
Computers|Duplicate|/'dju:plikit/|Sao chép, tạo bản sao giống hệt|Duplicate copy.|Copy, Replicate|Original
Computers|Failure|/'feiljə/|Sự hỏng hóc, thất bại trong hoạt động|System failure.|Breakdown|Success
Computers|Figure out|/'figjə/|Tìm hiểu, giải quyết hoặc hiểu ra điều gì|Figure out why.|Solve|Misunderstand
Computers|Ignore|/ig'nɔ:/|Bỏ qua, không chú ý đến|Ignore warnings.|Disregard|Heed
Computers|Search|/sə:tʃ/|Tìm kiếm thông tin trên hệ thống|Search online.|Seek, Hunt|Find
Computers|Shut down|/ʃʌt daʊn/|Tắt máy, ngừng hoạt động hệ thống|Shut down PC.|Turn off|Start up
Computers|Warning|/'wɔ:niɳ/|Cảnh báo về nguy hiểm hoặc vấn đề|Warning sign.|Caution, Alert|Approval
Office Tech|Affordable|/əˈfɔːd/|Có giá phải chăng, có khả năng chi trả được|Affordable price.|Cheap, Reasonable|Expensive
Office Tech|As needed|/ni:did/|Khi cần thiết, theo nhu cầu phát sinh|Update as needed.|When necessary|Always
Office Tech|Be in charge of|/tʃɑ:dʤ/|Chịu trách nhiệm, phụ trách công việc|In charge of sales.|Responsible for|Subordinate to
Office Tech|Capacity|/kə'pæsiti/|Sức chứa, dung lượng; năng lực|Storage capacity.|Volume, Size|Incapacity
Office Tech|Durable|/ˈdjʊərəbl/|Bền, có độ bền cao, sử dụng lâu dài|Durable material.|Long-lasting|Fragile
Office Tech|Initiative|/i'niʃiətiv/|Sáng kiến, tính chủ động trong công việc|Take initiative.|Drive|Apathy
Office Tech|Physically|/ˈfɪzɪkli/|Về mặt vật lý, thể chất|Physically fit.|Bodily|Mentally
Office Tech|Provider|/prə'vaidə/|Nhà cung cấp dịch vụ hoặc sản phẩm|Service provider.|Supplier|Consumer
Office Tech|Recur|/ri'kə:/|Tái diễn, xảy ra lại nhiều lần|Error recurs.|Repeat|Cease
Office Tech|Reduction|/ri'dʌkʃn/|Sự giảm bớt, cắt giảm (chi phí, số lượng)|Cost reduction.|Decrease|Increase
Office Tech|Stay on top of|/tɔp/|Nắm bắt tình hình, theo dõi sát sao|Stay on top of work.|Keep up with|Fall behind
Office Tech|Stock|/stɒk/|Hàng dự trữ, hàng tồn kho|In stock.|Inventory|Debt
Procedures|Appreciation|/ə,pri:ʃi'eiʃn/|Sự đánh giá cao, lòng biết ơn|Show appreciation.|Gratitude|Ingratitude
Procedures|Be made of|/meid/|Được làm bằng (vật liệu gì)|Made of steel.|Consist of|N/A
Procedures|Bring in|/briɳ/|Tuyển dụng; đưa vào, mang lại (lợi nhuận)|Bring in experts.|Hire, Introduce|Remove
Procedures|Casually|/ˈkæʒuəli/|Một cách bình thường, không trang trọng, xuề xòa|Dress casually.|Informally|Formally
Procedures|Code|/koud/|Quy định, quy tắc; mã số|Dress code.|Rule, Law|N/A
Procedures|Expose|/iks'pouz/|Phơi bày, vạch trần sự thật|Expose the truth.|Reveal|Hide
Procedures|Glimpse|/glimps/|Cái nhìn thoáng qua, chớp nhoáng|Catch a glimpse.|Glance, Peek|Stare
Procedures|Out of|/aut/|Hết, cạn kiệt, không còn (hàng, tiền)|Out of stock.|Lacking|Full of
Procedures|Outdated|/aut'deitid/|Lỗi thời, không còn phù hợp với thời đại|Outdated system.|Obsolete|Modern
Procedures|Practice|/'præktis/|Thực hành; thói quen, tập quán trong công việc|Practice daily.|Habit, Custom|Theory
Procedures|Reinforce|/,ri:in'fɔ:s/|Tăng cường, củng cố (quy định, kỹ năng)|Reinforce rules.|Strengthen|Weaken
Procedures|Verbally|/'və:bəli/|Bằng lời nói, bằng miệng (không viết)|Agreed verbally.|Orally|Written
Electronics|Answering machine|/ˈɑːnsərɪŋ məˈʃiːn/|Máy trả lời tự động ghi lại tin nhắn khi chủ nhân vắng mặt|Check the answering machine for messages.|Voicemail system|N/A
Electronics|Automation|/ˌɔːtəˈmeɪʃn/|Tự động hóa, việc sử dụng máy móc thay con người|Factory automation increases efficiency.|Mechanization|Manual operation
Electronics|Bandwidth|/ˈbændwɪdθ/|Băng thông, khả năng truyền dữ liệu của mạng|High bandwidth allows faster downloads.|Data capacity|N/A
Electronics|Battery|/ˈbætəri/|Pin, ắc quy cung cấp điện cho thiết bị|My phone battery is almost dead.|Power cell|N/A
Electronics|Capacity|/kəˈpæsəti/|Dung lượng lưu trữ hoặc khả năng chứa đựng|This hard drive has 1TB capacity.|Storage space, Volume|Incapacity
Electronics|Circuitry|/ˈsɜːrkɪtri/|Hệ thống mạch điện trong thiết bị điện tử|The circuitry was damaged by water.|Electronic circuits|N/A
Electronics|Disk drive|/dɪsk draɪv/|Ổ đĩa, thiết bị đọc và ghi dữ liệu trên đĩa|Save the file to the external disk drive.|Hard drive, Storage device|N/A
Electronics|Duplicate|/ˈduːplɪkeɪt/|Sao chép, tạo bản sao giống hệt nguyên bản|Please duplicate this CD for backup.|Copy, Replicate|Original
Electronics|Earbuds|/ˈɪəbʌdz/|Tai nghe nhỏ đặt vào trong tai|She uses wireless earbuds during workouts.|Earphones, In-ear headphones|Speakers
Electronics|Fehler|/ˈfeɪljər/|Sự hỏng hóc, lỗi hoặc thất bại của hệ thống|System failure caused data loss.|Breakdown, Malfunction|Success
Electronics|Jack|/dʒæk/|Ổ cắm để kết nối thiết bị điện tử|Plug headphones into the audio jack.|Socket, Port|N/A
Electronics|Minimal|/ˈmɪnɪməl/|Tối thiểu, ở mức độ nhỏ nhất có thể|The device requires minimal maintenance.|Minimum, Smallest|Maximum
Electronics|Multitask|/ˌmʌltiˈtæsk/|Đa nhiệm, thực hiện nhiều tác vụ cùng lúc|This computer can multitask efficiently.|Do multiple tasks|Single-task
Electronics|Optical|/ˈɑːptɪkl/|Quang học, liên quan đến ánh sáng và thị giác|Optical fibers transmit data using light.|Visual, Light-based|Electrical
Electronics|Physically|/ˈfɪzɪkli/|Về mặt vật lý, thực tế hữu hình|The drive was physically damaged.|Bodily, Materially|Virtually
Electronics|Reception|/rɪˈsepʃn/|Sự tiếp nhận tín hiệu (radio, TV, điện thoại)|Poor reception affects call quality.|Signal strength|Transmission
Electronics|Shut down|/ʃʌt daʊn/|Tắt máy, ngừng hoạt động hoàn toàn|Shut down the computer before leaving.|Turn off, Power off|Start up, Boot up
Electronics|Tablet|/ˈtæblət/|Máy tính bảng, thiết bị cảm ứng di động|She takes notes on her tablet.|iPad, Touchscreen device|Desktop
Electronics|Transmit|/trænzˈmɪt/|Truyền tải (dữ liệu, tín hiệu) từ nơi này sang nơi khác|Satellites transmit signals worldwide.|Send, Broadcast|Receive
Electronics|USB|/ˌjuː es ˈbiː/|Cổng kết nối chuẩn cho máy tính và thiết bị|Connect the printer via USB cable.|Universal Serial Bus|N/A
Electronics|Voltage|/ˈvoʊltɪdʒ/|Điện áp, lực điện đo bằng volt|This device requires 220V voltage.|Electric potential|N/A
Electronics|Warranty|/ˈwɔːrənti/|Bảo hành, cam kết sửa chữa miễn phí trong thời hạn|The laptop comes with a 2-year warranty.|Guarantee|N/A
Correspondence|Acknowledge|/əkˈnɑːlɪdʒ/|Thừa nhận, xác nhận đã nhận được thông tin|Please acknowledge receipt of this email.|Confirm, Recognize|Deny
Correspondence|Attachment|/əˈtætʃmənt/|File đính kèm trong email|The contract is in the attachment.|Enclosure, Appendix|N/A
Correspondence|Courier|/ˈkʊriər/|Người chuyển phát nhanh hoặc dịch vụ giao hàng|Send the documents by courier.|Messenger, Delivery service|Recipient
Correspondence|Delay|/dɪˈleɪ/|Sự chậm trễ, hoãn lại so với dự kiến|Apologize for the delay in response.|Postponement, Holdup|Promptness
Correspondence|Envelope|/ˈenvəloʊp/|Phong bì dùng để đựng thư|Put the letter in an envelope.|Wrapper, Cover|N/A
Correspondence|Fax|/fæks/|Máy fax hoặc hành động gửi văn bản qua fax|Please fax the signed agreement.|Facsimile, Telefax|N/A
Correspondence|Forward|/ˈfɔːrwərd/|Chuyển tiếp (email, thư) cho người khác|Forward this email to the manager.|Send on, Redirect|Hold, Keep
Correspondence|Greet|/ɡriːt/|Chào hỏi, gửi lời chào trong thư tín|Begin by greeting the recipient formally.|Welcome, Salute|Ignore
Correspondence|Heading|/ˈhedɪŋ/|Tiêu đề, phần đầu của văn bản hoặc thư|Use a clear heading for each section.|Title, Header|Footer
Correspondence|Letterhead|/ˈletərhed/|Tiêu đề có in sẵn logo, địa chỉ công ty trên giấy|Use company letterhead for official letters.|Stationery header|N/A
Correspondence|Mention|/ˈmenʃn/|Đề cập, nhắc đến điều gì đó trong văn bản|He mentioned the meeting in his email.|Refer to, Cite|Omit
Correspondence|Postage|/ˈpoʊstɪdʒ/|Cước phí bưu điện để gửi thư|Calculate postage for international mail.|Mailing cost, Stamp fee|N/A
Correspondence|Prompt|/prɑːmpt/|Nhanh chóng, kịp thời không chậm trễ|Thank you for your prompt reply.|Quick, Immediate|Delayed
Correspondence|Recipient|/rɪˈsɪpiənt/|Người nhận thư hoặc email|Address the letter to the correct recipient.|Receiver, Addressee|Sender
Correspondence|Reply|/rɪˈplaɪ/|Trả lời, hồi âm lại thư hoặc email|Please reply at your earliest convenience.|Respond, Answer|Ignore
Correspondence|Salutation|/ˌsæljuˈteɪʃn/|Lời chào đầu thư (Dear Sir/Madam)|Use an appropriate salutation.|Greeting, Opening|Closing
Correspondence|Send|/send/|Gửi đi (thư, email, hàng hóa)|Send the invoice by email.|Dispatch, Mail|Receive
Correspondence|Subject line|/ˈsʌbdʒɪkt laɪn/|Dòng tiêu đề ngắn gọn của email|Write a clear subject line.|Email header, Topic|Body
Correspondence|To whom it may concern|/tuː huːm ɪt meɪ kənˈsɜːrn/|Kính gửi (dùng khi không biết tên người nhận)|Begin with "To whom it may concern."|Generic salutation|Personal greeting
Correspondence|Urgent|/ˈɜːrdʒənt/|Khẩn cấp, cần xử lý ngay lập tức|Mark the email as urgent.|Pressing, Critical|Unimportant
Job Ads & Recruiting|Abundant|/əˈbʌndənt/|Dồi dào, có nhiều ứng viên hoặc cơ hội việc làm|Job opportunities are abundant this year.|Plentiful, Ample|Scarce
Job Ads & Recruiting|Accomplishment|/əˈkɑːmplɪʃmənt/|Thành tích, điều đã đạt được trong sự nghiệp|List your accomplishments on the resume.|Achievement, Success|Failure
Job Ads & Recruiting|Applicant|/ˈæplɪkənt/|Người nộp đơn xin việc|We received 50 applicants for the position.|Candidate, Job seeker|Employer
Job Ads & Recruiting|Bring together|/brɪŋ təˈɡeðər/|Tập hợp, quy tụ nhiều người hoặc tài năng|Bring together a talented team.|Assemble, Unite|Separate
Job Ads & Recruiting|Candidate|/ˈkændɪdeɪt/|Ứng viên được xem xét cho vị trí hoặc chức vụ|The candidate impressed the interviewers.|Applicant, Nominee|Employer
Job Ads & Recruiting|Come up with|/kʌm ʌp wɪð/|Nghĩ ra, đưa ra (ý tưởng, giải pháp)|Come up with creative marketing ideas.|Think of, Devise|Ignore
Job Ads & Recruiting|Commensurate|/kəˈmensərət/|Tương xứng, cân đối với (kinh nghiệm, trình độ)|Salary commensurate with experience.|Proportional, Equivalent|Disproportionate
Job Ads & Recruiting|Match|/mætʃ/|Phù hợp, kết nối đúng người với công việc|Match candidates to suitable positions.|Pair, Fit|Mismatch
Job Ads & Recruiting|Profile|/ˈproʊfaɪl/|Hồ sơ năng lực, bộ đặc điểm của ứng viên lý tưởng|He doesn't fit the job profile.|Characteristics, Description|N/A
Job Ads & Recruiting|Qualifications|/ˌkwɑːlɪfɪˈkeɪʃnz/|Trình độ, bằng cấp và kỹ năng cần thiết cho công việc|List your qualifications clearly.|Credentials, Requirements|Disqualifications
Job Ads & Recruiting|Recruit|/rɪˈkruːt/|Tuyển dụng, thu hút người tham gia tổ chức|The company recruits top graduates.|Hire, Enlist|Dismiss
Job Ads & Recruiting|Submit|/səbˈmɪt/|Nộp, gửi (hồ sơ, đơn xin việc)|Submit your resume online.|Send in, Present|Withdraw
Applying & Interviewing|Ability|/əˈbɪləti/|Khả năng, năng lực thực hiện công việc|Demonstrate your leadership ability.|Capability, Skill|Inability
Applying & Interviewing|Background|/ˈbækɡraʊnd/|Quá trình học tập và làm việc trước đây|Tell me about your educational background.|History, Experience|Foreground
Applying & Interviewing|Candidate|/ˈkændɪdeɪt/|Ứng viên tham gia phỏng vấn|The candidate arrived on time.|Applicant, Interviewee|Interviewer
Applying & Interviewing|Confident|/ˈkɑːnfɪdənt/|Tự tin, tin tưởng vào khả năng bản thân|She appeared confident during the interview.|Self-assured, Certain|Insecure
Applying & Interviewing|Cover letter|/ˈkʌvər ˈletər/|Thư xin việc đi kèm hồ sơ giới thiệu bản thân|Attach a cover letter with your resume.|Application letter|N/A
Applying & Interviewing|Employment|/ɪmˈplɔɪmənt/|Việc làm, công ăn việc làm|Seeking full-time employment.|Job, Work|Unemployment
Applying & Interviewing|Follow up|/ˈfɑːloʊ ʌp/|Theo dõi, liên hệ lại sau khi nộp đơn hoặc phỏng vấn|Follow up with a thank-you email.|Check back, Contact again|Ignore
Applying & Interviewing|Impression|/ɪmˈpreʃn/|Ấn tượng, cảm nhận ban đầu về ai đó|Make a good first impression.|Perception, Impact|N/A
Applying & Interviewing|Inquire|/ɪnˈkwaɪər/|Hỏi thăm, tìm hiểu thông tin|Inquire about the job opening.|Ask, Investigate|Answer
Applying & Interviewing|Negotiate|/nɪˈɡoʊʃieɪt/|Thương lượng, đàm phán về lương hoặc điều kiện|Negotiate salary and benefits.|Discuss, Bargain|Accept
Applying & Interviewing|Prepare|/prɪˈper/|Chuẩn bị trước cho phỏng vấn hoặc sự kiện|Prepare answers to common questions.|Get ready, Plan|Neglect
Applying & Interviewing|Reference|/ˈrefrəns/|Người tham chiếu xác nhận năng lực của bạn|Provide three professional references.|Recommendation, Referral|N/A
Applying & Interviewing|Resume|/ˈrezəmeɪ/|Sơ yếu lý lịch liệt kê kinh nghiệm và kỹ năng|Update your resume regularly.|CV, Curriculum Vitae|N/A
Applying & Interviewing|Strength|/streŋθ/|Điểm mạnh, thế mạnh của ứng viên|Discuss your strengths and weaknesses.|Advantage, Asset|Weakness
Hiring & Training|Conduct|/kənˈdʌkt/|Tiến hành, thực hiện (đào tạo, họp)|Conduct training sessions for new hires.|Carry out, Perform|Neglect
Hiring & Training|Develop|/dɪˈveləp/|Phát triển kỹ năng hoặc chương trình đào tạo|Develop employee skills through workshops.|Improve, Enhance|Stagnate
Hiring & Training|Effectively|/ɪˈfektɪvli/|Một cách hiệu quả, đạt kết quả tốt|Train employees effectively.|Efficiently, Successfully|Ineffectively
Hiring & Training|Evaluate|/ɪˈvæljueɪt/|Đánh giá hiệu suất hoặc kết quả đào tạo|Evaluate employee performance annually.|Assess, Appraise|Ignore
Hiring & Training|Hire|/ˈhaɪər/|Tuyển dụng, thuê người làm việc|We plan to hire 10 new employees.|Employ, Recruit|Fire
Hiring & Training|Mentor|/ˈmentɔːr/|Người cố vấn, hướng dẫn nhân viên mới|Assign a mentor to each trainee.|Coach, Advisor|Student
Hiring & Training|Onboarding|/ˈɑːnbɔːrdɪŋ/|Quá trình đưa nhân viên mới vào làm việc|Onboarding takes two weeks.|Orientation, Integration|Offboarding
Hiring & Training|Orientation|/ˌɔːriənˈteɪʃn/|Định hướng, giới thiệu công ty cho nhân viên mới|Attend orientation on your first day.|Introduction, Training|N/A
Hiring & Training|Probation|/proʊˈbeɪʃn/|Thời gian thử việc trước khi chính thức|Complete a 3-month probation period.|Trial period, Evaluation|Permanent status
Hiring & Training|Retain|/rɪˈteɪn/|Giữ chân nhân viên, duy trì lực lượng lao động|Retain talented employees with benefits.|Keep, Maintain|Lose
Hiring & Training|Skill|/skɪl/|Kỹ năng, khả năng thực hiện công việc cụ thể|Improve technical skills through training.|Ability, Expertise|Inability
Hiring & Training|Train|/treɪn/|Đào tạo, huấn luyện nhân viên|Train staff on new software.|Teach, Instruct|Ignore
Salaries & Benefits|Basis|/ˈbeɪsɪs/|Cơ sở, nền tảng để tính toán hoặc quyết định điều gì|Salary is paid on a monthly basis.|Foundation, Base|N/A
Salaries & Benefits|Benefit|/ˈbenɪfɪt/|Phúc lợi, lợi ích ngoài lương như bảo hiểm, nghỉ phép|The company offers excellent health benefits.|Advantage, Perk|Disadvantage
Salaries & Benefits|Bonus|/ˈboʊnəs/|Tiền thưởng thêm ngoài lương cơ bản|Employees receive a year-end bonus.|Incentive, Extra payment|Penalty
Salaries & Benefits|Compensate|/ˈkɑːmpenseɪt/|Bồi thường, đền bù cho thiệt hại hoặc công sức|The company compensates for overtime work.|Reimburse, Pay|Withhold
Salaries & Benefits|Compensation|/ˌkɑːmpenˈseɪʃn/|Toàn bộ tiền lương và phúc lợi nhận được|Total compensation includes salary and benefits.|Remuneration, Payment|N/A
Salaries & Benefits|Deduct|/dɪˈdʌkt/|Khấu trừ, trừ đi một phần từ lương|Taxes are deducted from monthly salary.|Subtract, Withhold|Add
Salaries & Benefits|Dental|/ˈdentl/|Liên quan đến răng, bảo hiểm nha khoa|We provide dental insurance coverage.|Tooth-related|N/A
Salaries & Benefits|Eligible|/ˈelɪdʒəbl/|Đủ điều kiện, được phép hưởng quyền lợi|Full-time employees are eligible for benefits.|Qualified, Entitled|Ineligible
Salaries & Benefits|Flex time|/fleks taɪm/|Thời gian làm việc linh hoạt theo nhu cầu|Employees enjoy flex time arrangements.|Flexible hours|Fixed schedule
Salaries & Benefits|Gross|/ɡroʊs/|Tổng thu nhập trước khi khấu trừ thuế và bảo hiểm|Her gross salary is $5,000 per month.|Total, Before deductions|Net
Salaries & Benefits|Hourly|/ˈaʊərli/|Theo giờ, được tính theo số giờ làm việc|She earns $20 on an hourly basis.|Per hour, By the hour|Salaried
Salaries & Benefits|Net|/net/|Lương thực nhận sau khi đã trừ thuế và các khoản khấu trừ|Net pay is lower than gross pay.|Take-home, After deductions|Gross
Salaries & Benefits|Overtime|/ˈoʊvərtaɪm/|Làm thêm giờ, thời gian làm việc ngoài giờ quy định|Overtime is paid at 1.5 times the regular rate.|Extra hours, Additional time|Regular hours
Salaries & Benefits|Package|/ˈpækɪdʒ/|Gói lương và phúc lợi toàn diện|The benefits package is very competitive.|Bundle, Set of benefits|N/A
Salaries & Benefits|Pension|/ˈpenʃn/|Lương hưu, tiền trả cho người về hưu|He receives a monthly pension after retirement.|Retirement fund|N/A
Salaries & Benefits|Raise|/reɪz/|Tăng lương, sự gia tăng tiền lương|She got a 5% raise this year.|Pay increase, Salary increment|Pay cut
Salaries & Benefits|Retirement|/rɪˈtaɪərmənt/|Nghỉ hưu, thời gian không còn làm việc|He plans for early retirement.|Pension age, Post-work life|Employment
Salaries & Benefits|Salary|/ˈsæləri/|Tiền lương cố định trả theo tháng hoặc năm|Annual salary is negotiable.|Wages, Pay|N/A
Salaries & Benefits|Vacation|/veɪˈkeɪʃn/|Kỳ nghỉ có hưởng lương|Employees get 15 days paid vacation.|Holiday, Leave|Work
Salaries & Benefits|Wage|/weɪdʒ/|Tiền công trả theo giờ hoặc ngày làm việc|Minimum wage has increased.|Pay, Earnings|N/A
Promotions, Pensions & Awards|Achievement|/əˈtʃiːvmənt/|Thành tích, điều đạt được qua nỗ lực|Her achievements earned her a promotion.|Accomplishment, Success|Failure
Promotions, Pensions & Awards|Advancement|/ədˈvænsmənt/|Sự thăng tiến trong sự nghiệp|Seek career advancement opportunities.|Progress, Promotion|Demotion
Promotions, Pensions & Awards|Contribute|/kənˈtrɪbjuːt/|Đóng góp công sức, tiền bạc vào quỹ hoặc dự án|Employees contribute to the pension fund.|Give, Donate|Withhold
Promotions, Pensions & Awards|Criteria|/kraɪˈtɪriə/|Tiêu chí, các yêu cầu để đánh giá hoặc lựa chọn|Meet the criteria for promotion.|Standards, Requirements|N/A
Promotions, Pensions & Awards|Deserving|/dɪˈzɜːrvɪŋ/|Xứng đáng, đáng được nhận thưởng hoặc ghi nhận|A deserving candidate for the award.|Worthy, Meritorious|Undeserving
Promotions, Pensions & Awards|Distribute|/dɪˈstrɪbjuːt/|Phân phối, trao tặng giải thưởng hoặc lợi nhuận|Distribute bonuses to all employees.|Hand out, Allocate|Collect
Promotions, Pensions & Awards|Employee of the month|/ɪmˈplɔɪiː əv ðə mʌnθ/|Nhân viên xuất sắc của tháng|She was named employee of the month.|Monthly award winner|N/A
Promotions, Pensions & Awards|Exceed|/ɪkˈsiːd/|Vượt qua, làm tốt hơn mong đợi|Exceed performance targets.|Surpass, Outperform|Fall short
Promotions, Pensions & Awards|Promote|/prəˈmoʊt/|Thăng chức, đề bạt lên vị trí cao hơn|He was promoted to manager.|Advance, Elevate|Demote
Promotions, Pensions & Awards|Promotion|/prəˈmoʊʃn/|Sự thăng chức, lên chức vụ cao hơn|She earned a promotion to director.|Advancement, Elevation|Demotion
Promotions, Pensions & Awards|Recognize|/ˈrekəɡnaɪz/|Công nhận, ghi nhận thành tích của ai đó|Recognize outstanding employee contributions.|Acknowledge, Appreciate|Ignore
Promotions, Pensions & Awards|Recognition|/ˌrekəɡˈnɪʃn/|Sự công nhận, ghi nhận giá trị hoặc đóng góp|Employee recognition boosts morale.|Acknowledgment, Appreciation|Neglect
Promotions, Pensions & Awards|Reward|/rɪˈwɔːrd/|Phần thưởng cho thành tích hoặc hành vi tốt|Reward employees for excellent performance.|Prize, Incentive|Punishment
Promotions, Pensions & Awards|Seniority|/siːniˈɔːrəti/|Thâm niên, thời gian phục vụ trong tổ chức|Promotions are based on seniority.|Length of service, Tenure|N/A
Shopping|Bargain|/ˈbɑːrɡən/|Món hời, sản phẩm có giá rẻ hơn bình thường|I got a great bargain on this coat.|Good deal, Discount|Rip-off
Shopping|Browse|/braʊz/|Dạo xem, xem qua các sản phẩm không có mục đích mua cụ thể|I like to browse online stores.|Look around, Survey|Buy immediately
Shopping|Cart|/kɑːrt/|Xe đẩy hàng trong siêu thị|Put items in your shopping cart.|Trolley, Basket|N/A
Shopping|Cash|/kæʃ/|Tiền mặt, thanh toán bằng tiền giấy hoặc xu|Pay in cash or by card.|Currency, Money|Credit
Shopping|Checkout|/ˈtʃekaʊt/|Quầy thanh toán trong cửa hàng|Wait in line at the checkout.|Cashier, Payment counter|Entrance
Shopping|Clearance|/ˈklɪrəns/|Bán thanh lý hàng tồn kho với giá giảm mạnh|Shop the clearance section for deals.|Sale, Liquidation|Regular price
Shopping|Consumer|/kənˈsuːmər/|Người tiêu dùng, người mua và sử dụng sản phẩm|Consumer rights must be protected.|Buyer, Customer|Seller
Shopping|Discount|/ˈdɪskaʊnt/|Giảm giá, khấu trừ một phần giá bán|Get a 20% discount on all items.|Reduction, Markdown|Markup
Shopping|Exchange|/ɪksˈtʃeɪndʒ/|Đổi hàng, thay sản phẩm khác cùng giá trị|Exchange the shirt for a different size.|Swap, Trade|Keep
Shopping|Item|/ˈaɪtəm/|Món hàng, sản phẩm riêng lẻ|Each item is carefully inspected.|Product, Article|N/A
Shopping|Mall|/mɔːl/|Trung tâm mua sắm lớn|Let's go to the shopping mall.|Shopping center, Plaza|N/A
Shopping|Purchase|/ˈpɜːrtʃəs/|Mua hàng, việc mua sản phẩm hoặc dịch vụ|Complete your purchase online.|Buy, Acquisition|Sale
Shopping|Receipt|/rɪˈsiːt/|Hóa đơn, giấy chứng nhận đã mua hàng|Keep your receipt for returns
Ordering Supplies|Catalog|/ˈkætəlɔːɡ/|Danh mục, sách giới thiệu sản phẩm để đặt hàng|Browse the catalog for office supplies.|Brochure, Product list|N/A
Ordering Supplies|Compile|/kəmˈpaɪl/|Tập hợp, lập danh sách các mục cần đặt|Compile a list of needed supplies.|Assemble, Collect|Scatter
Ordering Supplies|Delivery|/dɪˈlɪvəri/|Việc giao hàng đến địa chỉ khách hàng|Expect delivery within 5 business days.|Shipment, Transport|Pickup
Ordering Supplies|Estimate|/ˈestɪmeɪt/|Ước tính chi phí hoặc thời gian giao hàng|Estimate shipping costs before ordering.|Approximate, Calculate|Know exactly
Ordering Supplies|Fulfill|/fʊlˈfɪl/|Hoàn thành, thực hiện đầy đủ đơn hàng|Fulfill orders within 24 hours.|Complete, Execute|Neglect
Ordering Supplies|Inventory|/ˈɪnvəntɔːri/|Hàng tồn kho, danh sách hàng hóa hiện có|Check inventory before placing orders.|Stock, Supplies|N/A
Ordering Supplies|Order form|/ˈɔːrdər fɔːrm/|Mẫu đơn đặt hàng cần điền thông tin sản phẩm|Fill out the order form completely.|Purchase form|N/A
Ordering Supplies|Place an order|/pleɪs ən ˈɔːrdər/|Đặt hàng, gửi yêu cầu mua hàng|Place an order online or by phone.|Submit an order, Buy|Cancel order
Ordering Supplies|Quantity|/ˈkwɑːntəti/|Số lượng, khối lượng hàng hóa đặt mua|Specify the quantity needed.|Amount, Volume|Quality
Ordering Supplies|Reorder|/ˌriːˈɔːrdər/|Đặt hàng lại, mua thêm hàng đã từng mua|Reorder supplies when stock is low.|Order again, Replenish|N/A
Ordering Supplies|Stationery|/ˈsteɪʃəneri/|Văn phòng phẩm như giấy, bút, phong bì|Order stationery for the office.|Office supplies, Writing materials|N/A
Ordering Supplies|Supplier|/səˈplaɪər/|Nhà cung cấp hàng hóa hoặc dịch vụ|Find a reliable supplier for materials.|Vendor, Provider|Customer
Ordering Supplies|Supply|/səˈplaɪ/|Cung cấp hàng hóa hoặc vật tư; nguồn cung|Supply office materials monthly.|Provide, Furnish|Demand
Shipping|Carrier|/ˈkæriər/|Hãng vận chuyển, công ty chuyên chở hàng hóa|Choose a reliable shipping carrier.|Transporter, Delivery company|Receiver
Shipping|Consignment|/kənˈsaɪnmənt/|Lô hàng gửi đi, hàng hóa ký gửi|Track the consignment until delivery.|Shipment, Cargo|N/A
Shipping|Courier|/ˈkʊriər/|Dịch vụ chuyển phát nhanh hoặc người đưa thư|Send documents by courier service.|Express delivery, Messenger|Regular mail
Shipping|Destination|/ˌdestɪˈneɪʃn/|Điểm đến, nơi hàng hóa được giao|The package reached its destination.|Final location, Endpoint|Origin
Shipping|Dispatch|/dɪˈspætʃ/|Gửi đi, phát hàng từ kho|Dispatch orders within 24 hours.|Send out, Ship|Receive
Shipping|Excursion|/ɪkˈskɜːrʒn/|Chuyến đi ngắn, hành trình vận chuyển|Plan the shipping excursion route.|Trip, Journey|N/A
Shipping|Fragile|/ˈfrædʒəl/|Dễ vỡ, cần xử lý cẩn thận khi vận chuyển|Mark the box as fragile.|Delicate, Breakable|Sturdy
Shipping|Insure|/ɪnˈʃʊr/|Mua bảo hiểm cho hàng hóa trong vận chuyển|Insure valuable shipments.|Protect, Cover|Risk
Shipping|Notify|/ˈnoʊtɪfaɪ/|Thông báo cho người nhận về tình trạng vận chuyển|Notify customers when orders ship.|Inform, Alert|Conceal
Shipping|Package|/ˈpækɪdʒ/|Kiện hàng, bưu kiện được đóng gói để gửi|Track your package online.|Parcel, Box|N/A
Shipping|Postage|/ˈpoʊstɪdʒ/|Phí bưu chính, tiền gửi hàng qua đường bưu điện|Calculate postage before mailing.|Shipping fee, Mailing cost|N/A
Shipping|Tracking number|/ˈtrækɪŋ ˈnʌmbər/|Mã số tra cứu để theo dõi hành trình hàng|Use the tracking number to check status.|Shipment ID, Trace code|N/A
Shipping|Transit|/ˈtrænzɪt/|Quá trình vận chuyển, đang trên đường giao hàng|The package is currently in transit.|Transportation, En route|Delivered
Shipping|Warehouse|/ˈwerhaʊs/|Nhà kho, nơi chứa hàng trước khi giao|Store goods in the warehouse.|Storage facility, Depot|Store
Invoices|Account|/əˈkaʊnt/|Tài khoản khách hàng ghi nhận giao dịch mua bán|Pay your account balance by the due date.|Customer record, Ledger|N/A
Invoices|Charge|/tʃɑːrdʒ/|Tính tiền, thu phí cho sản phẩm hoặc dịch vụ|Additional charges apply for rush orders.|Fee, Cost|Refund
Invoices|Compile|/kəmˈpaɪl/|Tập hợp, lập danh sách các khoản phí trong hóa đơn|Compile all expenses into one invoice.|Gather, Assemble|Separate
Invoices|Customer|/ˈkʌstəmər/|Khách hàng, người mua hàng hoặc sử dụng dịch vụ|Send invoices to customers promptly.|Client, Buyer|Seller
Invoices|Discount|/ˈdɪskaʊnt/|Giảm giá cho khách hàng thanh toán sớm|Offer a 5% discount for early payment.|Reduction, Deduction|Surcharge
Invoices|Due date|/duː deɪt/|Ngày đến hạn thanh toán hóa đơn|Payment is due by the due date.|Deadline, Payment date|N/A
Invoices|Efficient|/ɪˈfɪʃnt/|Hiệu quả, xử lý nhanh chóng và chính xác|An efficient invoicing system saves time.|Effective, Productive|Inefficient
Invoices|Impose|/ɪmˈpoʊz/|Áp đặt, đưa ra phí hoặc hình phạt bổ sung|Impose late fees on overdue accounts.|Levy, Enforce|Waive
Invoices|Mistake|/mɪˈsteɪk/|Lỗi, sai sót trong tính toán hoặc thông tin|Correct any mistakes on the invoice.|Error, Inaccuracy|Accuracy
Invoices|Order|/ˈɔːrdər/|Đơn hàng, yêu cầu mua sản phẩm|The invoice matches the purchase order.|Purchase, Request|Cancellation
Invoices|Promptly|/ˈprɑːmptli/|Một cách nhanh chóng, kịp thời|Pay invoices promptly to avoid penalties.|Quickly, Immediately|Slowly
Invoices|Record|/ˈrekərd/|Ghi chép, lưu lại thông tin giao dịch|Record all transactions for accounting.|Document, Register|Forget
Invoices|Terms|/tɜːrmz/|Điều khoản thanh toán như thời hạn, phương thức|Read the payment terms carefully.|Conditions, Stipulations|N/A
        `;

        const parseData = (str) => {
            return str.trim().split('\n').filter(line => line.trim() !== '').map((line, index) => {
                const parts = line.split('|');
                return {
                    id: index + 1,
                    topic: parts[0],
                    word: parts[1],
                    ipa: parts[2],
                    meaning: parts[3],
                    example: parts[4],
                    synonym: parts[5] || "N/A",
                    antonym: parts[6] || "N/A"
                };
            });
        };

        const toeicData = parseData(rawDataString);

        // --- SOUND HELPER ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const playSound = (type) => {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            const now = audioCtx.currentTime;
            if (type === 'flip') {
                osc.type = 'sine'; osc.frequency.setValueAtTime(600, now); osc.frequency.exponentialRampToValueAtTime(800, now + 0.05); gainNode.gain.setValueAtTime(0.1, now); gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.05); osc.start(now); osc.stop(now + 0.05);
            } else if (type === 'match') {
                osc.type = 'triangle'; osc.frequency.setValueAtTime(523.25, now); osc.frequency.setValueAtTime(659.25, now + 0.1); gainNode.gain.setValueAtTime(0.1, now); gainNode.gain.linearRampToValueAtTime(0, now + 0.4); osc.start(now); osc.stop(now + 0.4);
            } else if (type === 'miss') {
                osc.type = 'sawtooth'; osc.frequency.setValueAtTime(150, now); osc.frequency.linearRampToValueAtTime(100, now + 0.2); gainNode.gain.setValueAtTime(0.1, now); gainNode.gain.linearRampToValueAtTime(0, now + 0.2); osc.start(now); osc.stop(now + 0.2);
            }
        };

        // --- COMPONENTS ---
        const SpeakerButton = ({ text, lang = 'US', className = "" }) => {
            const speak = (e) => {
                e.stopPropagation();
                if ('speechSynthesis' in window) {
                    window.speechSynthesis.cancel();
                    const utterance = new SpeechSynthesisUtterance(text);
                    const voices = window.speechSynthesis.getVoices();
                    let voice = null;
                    if (lang === 'US') voice = voices.find(v => v.lang === 'en-US' && !v.name.includes('UK'));
                    else voice = voices.find(v => v.lang === 'en-GB' || v.name.includes('UK'));
                    if (voice) utterance.voice = voice; else utterance.lang = lang === 'US' ? 'en-US' : 'en-GB';
                    utterance.rate = 0.9;
                    window.speechSynthesis.speak(utterance);
                }
            };
            return ( <button onClick={speak} className={`inline-flex items-center justify-center gap-1 px-2 py-1 rounded text-[10px] font-bold transition-all border ${className} ${lang === 'US' ? 'bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100' : 'bg-red-50 text-red-700 border-red-200 hover:bg-red-100'}`} title={lang === 'US' ? 'Giọng Mỹ (US)' : 'Giọng Anh (UK)'}> <i className="fas fa-volume-up"></i> {lang} </button> );
        };

        const LinkedWordList = ({ text, jumpToWord, colorClass = "text-gray-600" }) => {
            if (!text || text === "N/A") return <span className="text-gray-400">N/A</span>;
            const words = text.split(',').map(w => w.trim());
            return ( <span> {words.map((w, i) => { const exists = toeicData.some(item => item.word.toLowerCase() === w.toLowerCase()); return ( <React.Fragment key={i}> {i > 0 && ", "} {exists ? ( <button onClick={(e) => { e.stopPropagation(); jumpToWord(w); }} className={`${colorClass} hover:underline font-semibold cursor-pointer`}>{w}</button> ) : ( <span className={colorClass}>{w}</span> )} </React.Fragment> ); })} </span> );
        };

        const WordItem = ({ item, isLearned, isDetailOpen, isHighlighted, toggleLearned, toggleDetails }) => (
            <div id={`word-${item.id}`} className={`p-4 rounded-lg border transition-all ${isHighlighted ? 'ring-2 ring-yellow-400 bg-yellow-50' : 'bg-white border-slate-200'} ${isLearned ? 'bg-emerald-50' : ''}`}>
                <div className="flex justify-between">
                    <div className="flex-1">
                        <div className="flex items-center gap-2 mb-1"> <span className="text-[10px] font-bold uppercase text-slate-500 bg-slate-100 px-1 rounded">{item.topic}</span> </div>
                        <div className="flex items-center gap-2 flex-wrap"> <h3 className="text-lg font-bold text-slate-800">{item.word}</h3> <div className="flex gap-1"> <SpeakerButton text={item.word} lang="US" /> <SpeakerButton text={item.word} lang="UK" /> </div> </div>
                        <p className="text-xs text-slate-500 font-mono mt-1">{item.ipa}</p>
                    </div>
                    <button onClick={() => toggleLearned(item.id)} className={`w-8 h-8 rounded-full flex items-center justify-center border ${isLearned ? 'bg-emerald-500 text-white' : 'text-gray-300'}`}><i className="fas fa-check"></i></button>
                </div>
                <div className="mt-2 pt-2 border-t border-slate-100">
                    <p className="font-medium text-sm text-slate-800">{item.meaning}</p>
                    <button onClick={() => toggleDetails(item.id)} className="text-xs text-indigo-500 font-semibold mt-1"> {isDetailOpen ? 'Thu gọn' : 'Chi tiết'} <i className={`fas fa-chevron-${isDetailOpen ? 'up' : 'down'}`}></i> </button>
                    {isDetailOpen && ( <div className="mt-2 text-xs text-slate-600 bg-slate-50 p-2 rounded"> <p><strong>Ví dụ:</strong> "{item.example}"</p> </div> )}
                </div>
            </div>
        );

        const WordListView = ({ data, learnedWords, toggleLearned, showDetails, toggleDetails, highlightedId }) => ( <div className="grid gap-3 md:grid-cols-2 lg:grid-cols-3"> {data.map(item => ( <WordItem key={item.id} item={item} isLearned={learnedWords.has(item.id)} isDetailOpen={showDetails === item.id} isHighlighted={highlightedId === item.id} toggleLearned={toggleLearned} toggleDetails={toggleDetails} /> ))} </div> );

        const FlashcardView = ({ data, learnedWords, toggleLearned }) => {
            const [index, setIndex] = React.useState(0);
            const [isFlipped, setIsFlipped] = React.useState(false);
            React.useEffect(() => { setIndex(0); setIsFlipped(false); }, [data.length]);
            const next = () => { setIsFlipped(false); setTimeout(() => setIndex(prev => (prev + 1) % data.length), 150); };
            const prev = () => { setIsFlipped(false); setTimeout(() => setIndex(prev => (prev - 1 + data.length) % data.length), 150); };
            if (data.length === 0) return <div className="text-center p-10 text-gray-400">Không có dữ liệu</div>;
            const item = data[index];
            const isLearned = learnedWords.has(item.id);
            return (
                <div className="flex flex-col items-center h-full justify-center py-4">
                    <div className="perspective-1000 w-full max-w-sm h-80 cursor-pointer group" onClick={() => setIsFlipped(!isFlipped)}>
                        <div className={`relative w-full h-full text-center transition-transform duration-500 transform-style-3d ${isFlipped ? 'rotate-y-180' : 'rotate-y-0'}`}>
                            <div className="card-face bg-white border-2 border-slate-200 hover:border-indigo-300 transition-colors">
                                <span className="absolute top-4 left-4 bg-slate-100 text-slate-500 text-[10px] font-bold px-2 py-1 rounded">{index + 1}/{data.length}</span>
                                <span className="absolute top-4 right-4 text-[10px] text-indigo-500 font-bold uppercase tracking-widest">{item.topic}</span>
                                <h2 className="text-4xl font-black text-slate-800 mb-2">{item.word}</h2>
                                <span className="text-lg text-slate-500 font-mono mb-4 bg-slate-50 px-2 rounded">{item.ipa}</span>
                                <div className="text-xs text-slate-400 animate-pulse mt-4 flex items-center gap-1"><i className="fas fa-sync-alt"></i> Chạm để lật</div>
                                <div className="flex gap-2 mt-4" onClick={(e) => e.stopPropagation()}> <SpeakerButton text={item.word} lang="US" /> <SpeakerButton text={item.word} lang="UK" /> </div>
                            </div>
                            <div className="card-face rotate-y-180 bg-slate-800 text-white">
                                <h3 className="text-2xl font-bold mb-2 text-yellow-400 px-4">{item.meaning}</h3>
                                <p className="text-sm italic opacity-90 mb-4 px-6 text-slate-300">"{item.example}"</p>
                                <div className="flex gap-4 absolute bottom-6"> <button onClick={(e) => { e.stopPropagation(); toggleLearned(item.id); }} className={`w-10 h-10 rounded-full flex items-center justify-center backdrop-blur-sm transition ${isLearned ? 'bg-green-500 text-white shadow-lg shadow-green-500/50' : 'bg-white/10 hover:bg-white/30'}`}><i className="fas fa-check"></i></button> </div>
                            </div>
                        </div>
                    </div>
                    <div className="flex items-center gap-6 mt-6"> <button onClick={prev} className="px-5 py-2 bg-white shadow-md rounded-full hover:bg-indigo-50 text-indigo-900 transition"><i className="fas fa-arrow-left"></i></button> <button onClick={next} className="px-5 py-2 bg-white shadow-md rounded-full hover:bg-indigo-50 text-indigo-900 transition"><i className="fas fa-arrow-right"></i></button> </div>
                </div>
            );
        };

        const QuizView = ({ allData, setCoins, user, speakWord }) => {
            const [currentQuestion, setCurrentQuestion] = React.useState(null);
            const [options, setOptions] = React.useState([]);
            const [selectedOption, setSelectedOption] = React.useState(null);
            const [isCorrect, setIsCorrect] = React.useState(null);
            const [streak, setStreak] = React.useState(0);
            const [bonus, setBonus] = React.useState(null);

            const generateQuestion = () => {
                const randomItem = allData[Math.floor(Math.random() * allData.length)];
                const distractors = [];
                while (distractors.length < 3) {
                    const d = allData[Math.floor(Math.random() * allData.length)];
                    if (d.id !== randomItem.id && !distractors.find(x => x.id === d.id)) {
                        distractors.push(d);
                    }
                }
                const allOptions = [...distractors, randomItem].sort(() => Math.random() - 0.5);
                setCurrentQuestion(randomItem);
                setOptions(allOptions);
                setSelectedOption(null);
                setIsCorrect(null);
                setBonus(null);
                speakWord(randomItem.word);
            };

            React.useEffect(() => { generateQuestion(); }, []);

            const handleAnswer = (option) => {
                if (selectedOption) return;
                setSelectedOption(option);
                const correct = option.id === currentQuestion.id;
                setIsCorrect(correct);
                if (correct) {
                    playSound('match');
                    let earned = 20;
                    let streakBonus = 0;
                    if (streak >= 2) streakBonus = 5;
                    if (streak >= 5) streakBonus = 10;
                    if (streak >= 10) streakBonus = 20;
                    const totalEarned = earned + streakBonus;
                    setBonus(totalEarned);
                    setCoins(prev => prev + totalEarned);
                    setStreak(s => s + 1);
                    if (user && db) {
                        const userRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('leaderboard').doc(user.uid);
                        const currentCoins = parseInt(localStorage.getItem('toeic_user_coins') || 0) + totalEarned;
                        userRef.set({ coins: currentCoins }, { merge: true });
                    }
                    setTimeout(generateQuestion, 1000);
                } else {
                    playSound('miss');
                    setStreak(0);
                    setTimeout(generateQuestion, 1500);
                }
            };

            if (!currentQuestion) return <div className="p-10 text-center">Đang tải câu hỏi...</div>;

            return (
                <div className="max-w-xl mx-auto py-6 px-4">
                    <div className="flex justify-between items-center mb-6">
                        <div className="text-orange-500 font-bold text-xl flex items-center gap-2"><i className="fas fa-fire"></i> {streak > 0 ? `Streak x${streak}` : 'Quiz Mode'}</div>
                        {bonus && (<div className="coin-float text-yellow-500 font-black text-2xl absolute right-10">+{bonus} <i className="fas fa-coins"></i></div>)}
                    </div>
                    <div className="bg-white p-8 rounded-2xl shadow-lg text-center mb-6 border-b-4 border-indigo-100">
                        <span className="text-xs font-bold text-indigo-400 uppercase tracking-widest mb-2 block">{currentQuestion.topic}</span>
                        <h2 className="text-4xl font-black text-slate-800 mb-2">{currentQuestion.word}</h2>
                        <div className="flex justify-center gap-2 mb-4">
                            <span className="text-slate-400 font-mono">{currentQuestion.ipa}</span>
                            <button onClick={() => speakWord(currentQuestion.word)} className="text-indigo-500 hover:text-indigo-700"><i className="fas fa-volume-up"></i></button>
                        </div>
                    </div>
                    <div className="grid grid-cols-1 gap-3">
                        {options.map((opt, idx) => {
                            let btnClass = "bg-white border-2 border-slate-200 text-slate-700 hover:border-indigo-300 hover:bg-indigo-50";
                            if (selectedOption) {
                                if (opt.id === currentQuestion.id) btnClass = "bg-green-100 border-green-500 text-green-800 font-bold";
                                else if (opt.id === selectedOption.id) btnClass = "bg-red-100 border-red-500 text-red-800 animate-shake";
                                else btnClass = "bg-slate-50 border-slate-100 text-slate-400 opacity-50";
                            }
                            return (
                                <button key={idx} onClick={() => handleAnswer(opt)} className={`p-4 rounded-xl text-left transition-all text-sm font-medium ${btnClass}`} disabled={!!selectedOption}>
                                    <span className="inline-block w-6 font-bold opacity-50">{['A', 'B', 'C', 'D'][idx]}.</span>
                                    {opt.meaning}
                                </button>
                            );
                        })}
                    </div>
                </div>
            );
        };

        const LeaderboardModal = ({ isOpen, onClose, user, coins }) => {
            const [leaders, setLeaders] = React.useState([]);
            const [name, setName] = React.useState('');
            const [isSaving, setIsSaving] = React.useState(false);
            React.useEffect(() => {
                if (isOpen) {
                    if (!db) return;
                    fetchLeaders();
                    if (user && !user.isAnonymous) {
                        const loadProfile = async () => {
                            const userRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('leaderboard').doc(user.uid);
                            try { const snap = await userRef.get(); if (snap.exists) setName(snap.data().displayName || user.displayName || ''); } catch (e) { console.error(e); }
                        };
                        loadProfile();
                    } else if (user) {
                         const loadProfile = async () => {
                            const userRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('leaderboard').doc(user.uid);
                            try { const snap = await userRef.get(); if (snap.exists) setName(snap.data().displayName || ''); } catch (e) { console.error(e); }
                        };
                        loadProfile();
                    }
                }
            }, [isOpen, user]);
            const fetchLeaders = async () => {
                if (!db) return;
                const colRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('leaderboard');
                colRef.onSnapshot((snapshot) => { const data = []; snapshot.forEach(doc => data.push(doc.data())); data.sort((a, b) => b.coins - a.coins); setLeaders(data.slice(0, 10)); });
            };
            const saveProfile = async () => {
                if (!name.trim() || !user || !db) return;
                setIsSaving(true);
                try {
                    const userRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('leaderboard').doc(user.uid);
                    await userRef.set({ userId: user.uid, displayName: name, coins: coins, updatedAt: new Date().toISOString() }, { merge: true });
                    alert("Đã lưu tên thành công!");
                } catch (e) { alert("Lỗi lưu tên."); } finally { setIsSaving(false); }
            };
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 bg-black/60 z-[60] flex items-center justify-center p-4 backdrop-blur-sm animate-fadeIn">
                    <div className="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden flex flex-col max-h-[90vh]">
                        <div className="p-5 bg-gradient-to-r from-yellow-400 to-orange-500 text-white flex justify-between items-center"> <h2 className="text-xl font-black flex items-center gap-2"><i className="fas fa-trophy"></i> Bảng Xếp Hạng</h2> <button onClick={onClose} className="hover:bg-white/20 p-2 rounded-full transition"><i className="fas fa-times"></i></button> </div>
                        <div className="p-5 overflow-y-auto flex-1">
                            {!db && <div className="p-3 mb-4 bg-red-100 text-red-700 text-xs rounded border border-red-200">Bạn chưa cấu hình Firebase.</div>}
                            <div className="bg-indigo-50 p-4 rounded-xl mb-6 border border-indigo-100">
                                <h3 className="font-bold text-indigo-900 mb-2 text-sm uppercase">Hồ sơ của bạn</h3>
                                <div className="flex gap-2"> <input type="text" className="flex-1 border rounded px-3 py-2 text-sm" placeholder="Tên hiển thị..." value={name} onChange={(e) => setName(e.target.value)} disabled={!db} /> <button onClick={saveProfile} disabled={isSaving || !db} className="bg-indigo-600 text-white px-4 py-2 rounded text-sm font-bold hover:bg-indigo-700 disabled:opacity-50">{isSaving ? '...' : 'Lưu'}</button> </div>
                            </div>
                            <div className="space-y-3"> {leaders.map((leader, index) => ( <div key={index} className={`flex items-center justify-between p-3 rounded-lg border ${leader.userId === user?.uid ? 'bg-yellow-50 border-yellow-300' : 'bg-white border-slate-100'}`}> <div className="flex items-center gap-3"> <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${index === 0 ? 'bg-yellow-400 text-white' : index === 1 ? 'bg-gray-300 text-white' : index === 2 ? 'bg-amber-600 text-white' : 'bg-slate-100 text-slate-500'}`}>{index + 1}</div> <div><div className="font-bold text-slate-800 text-sm">{leader.displayName || 'Ẩn danh'}</div>{leader.userId === user?.uid && <span className="text-[10px] text-indigo-500 font-bold bg-indigo-100 px-1.5 rounded">Bạn</span>}</div> </div> <div className="font-black text-indigo-600 flex items-center gap-1">{leader.coins.toLocaleString()} <i className="fas fa-coins text-yellow-500 text-xs"></i></div> </div> ))} {leaders.length === 0 && <p className="text-center text-gray-400 text-sm">{db ? "Chưa có dữ liệu." : "Vui lòng kết nối Firebase."}</p>} </div>
                        </div>
                    </div>
                </div>
            );
        };

        const MemoryGameView = ({ allData, setCoins, user, coins }) => {
            const [gameMode, setGameMode] = React.useState(null); 
            const [cards, setCards] = React.useState([]);
            const [flippedIndices, setFlippedIndices] = React.useState([]);
            const [matchedIndices, setMatchedIndices] = React.useState([]);
            const [level, setLevel] = React.useState(1);
            const [levelComplete, setLevelComplete] = React.useState(false);
            const [processing, setProcessing] = React.useState(false);
            const [matchedItem, setMatchedItem] = React.useState(null);
            const [currentPlayer, setCurrentPlayer] = React.useState(1);
            const [scores, setScores] = React.useState({ 1: 0, 2: 0 });
            const [pvpWinner, setPvPWinner] = React.useState(null);
            const [aiMemory, setAiMemory] = React.useState({});
            const [aiTargets, setAiTargets] = React.useState([]);
            const [roomId, setRoomId] = React.useState('');
            const [isHost, setIsHost] = React.useState(false);
            const [onlineStatus, setOnlineStatus] = React.useState('idle'); 
            const [inputRoomId, setInputRoomId] = React.useState('');
            const [hasPaid, setHasPaid] = React.useState(false); 

            const speak = (text) => {
                if ('speechSynthesis' in window) {
                    window.speechSynthesis.cancel();
                    const u = new SpeechSynthesisUtterance(text);
                    u.lang = 'en-US';
                    window.speechSynthesis.speak(u);
                }
            };

            const calculateAiMoves = () => {
                const memoryIndices = Object.keys(aiMemory).map(Number).filter(idx => !matchedIndices.includes(idx));
                let firstIdx = -1; let secondIdx = -1;
                for (let i = 0; i < memoryIndices.length; i++) { for (let j = i + 1; j < memoryIndices.length; j++) { const idxA = memoryIndices[i]; const idxB = memoryIndices[j]; if (cards[idxA].itemId === cards[idxB].itemId) { firstIdx = idxA; secondIdx = idxB; break; } } if (firstIdx !== -1) break; }
                if (firstIdx === -1) {
                    const unknownIndices = cards.map((_, i) => i).filter(i => !matchedIndices.includes(i) && !memoryIndices.includes(i));
                    const allAvailable = cards.map((_, i) => i).filter(i => !matchedIndices.includes(i));
                    if (unknownIndices.length > 0) firstIdx = unknownIndices[Math.floor(Math.random() * unknownIndices.length)]; else firstIdx = allAvailable[Math.floor(Math.random() * allAvailable.length)];
                    const firstCard = cards[firstIdx];
                    const matchInMemory = memoryIndices.find(idx => cards[idx].itemId === firstCard.itemId && idx !== firstIdx);
                    if (matchInMemory !== undefined) secondIdx = matchInMemory; else { const remaining = allAvailable.filter(i => i !== firstIdx); secondIdx = remaining[Math.floor(Math.random() * remaining.length)]; }
                }
                return [firstIdx, secondIdx];
            };

            const handleCardClick = (index) => {
                if (gameMode === 'pvp_online') { handleOnlineCardClick(index); return; }
                if (processing || flippedIndices.includes(index) || matchedIndices.includes(index)) return;
                playSound('flip');
                const newFlipped = [...flippedIndices, index];
                setFlippedIndices(newFlipped);
                setAiMemory(prev => ({ ...prev, [index]: cards[index].itemId }));
                if (newFlipped.length === 2) { setProcessing(true); checkForMatch(newFlipped); }
            };

            const performAiTurn = () => {
                if (aiTargets.length === 0) {
                    const moves = calculateAiMoves();
                    setAiTargets(moves);
                }
            };

            const checkForMatch = ([idx1, idx2]) => {
                const card1 = cards[idx1];
                const card2 = cards[idx2];
                const isMatch = card1.itemId === card2.itemId;
                if (isMatch) {
                    setTimeout(() => {
                        playSound('match');
                        const wordToSpeak = card1.type === 'word' ? card1.content : card2.content;
                        speak(wordToSpeak);
                        const newMatched = [...matchedIndices, idx1, idx2];
                        setMatchedIndices(newMatched);
                        setFlippedIndices([]);
                        setProcessing(false);
                        
                        const matchedId = card1.itemId;
                        const itemDetails = allData.find(i => i.id === matchedId);
                        setMatchedItem(itemDetails);

                        if (gameMode === 'solo') {
                            setCoins(prev => prev + 100);
                            if (user && db) {
                                const userRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('leaderboard').doc(user.uid);
                                const currentCoins = parseInt(localStorage.getItem('toeic_user_coins') || 0) + 100;
                                userRef.set({ coins: currentCoins }, { merge: true });
                            }
                        } else { setScores(prev => ({ ...prev, [currentPlayer]: prev[currentPlayer] + 100 })); }
                        
                        if (newMatched.length === cards.length) {
                            if (gameMode === 'solo') { setTimeout(() => setLevelComplete(true), 500); } 
                            else { setTimeout(() => { const winner = scores[1] > scores[2] ? 1 : (scores[2] > scores[1] ? 2 : 'draw'); setPvPWinner(winner); }, 500); }
                        }
                    }, 600);
                } else {
                    setTimeout(() => {
                        playSound('miss');
                        setFlippedIndices([]);
                        setProcessing(false);
                        if (gameMode === 'ai') { setCurrentPlayer(prev => prev === 1 ? 2 : 1); }
                    }, 1000);
                }
            };

            const handleOnlineCardClick = async (index) => {
                const amIHost = isHost;
                if (processing) return; 
                const isMyTurn = (amIHost && currentPlayer === 1) || (!amIHost && currentPlayer === 2);
                if (!isMyTurn) return; 
                if (flippedIndices.includes(index) || matchedIndices.includes(index)) return;
                playSound('flip');
                const roomRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('rooms').doc(roomId);
                const newFlipped = [...flippedIndices, index];
                await roomRef.update({ flipped: newFlipped });
                if (newFlipped.length === 2) {
                    await roomRef.update({ processing: true });
                    const card1 = cards[newFlipped[0]];
                    const card2 = cards[newFlipped[1]];
                    const isMatch = card1.itemId === card2.itemId;
                    if (isMatch) {
                        setTimeout(async () => {
                            playSound('match');
                            const wordToSpeak = card1.type === 'word' ? card1.content : card2.content;
                            speak(wordToSpeak);
                            
                            const matchedId = card1.itemId;
                            const itemDetails = allData.find(i => i.id === matchedId);
                            setMatchedItem(itemDetails);

                            const newMatched = [...matchedIndices, ...newFlipped];
                            const newScores = { ...scores };
                            if (amIHost) newScores.host += 100; else newScores.guest += 100;
                            await roomRef.update({ matched: newMatched, flipped: [], scores: newScores, processing: false });
                        }, 600);
                    } else {
                        setTimeout(async () => {
                            playSound('miss');
                            const doc = await roomRef.get();
                            const currentData = doc.data();
                            const nextTurn = currentData.turn === currentData.hostId ? currentData.guestId : currentData.hostId;
                            await roomRef.update({ flipped: [], processing: false, turn: nextTurn });
                        }, 1000);
                    }
                }
            };

            // AI Logic Hook 1
            React.useEffect(() => {
                 if (gameMode === 'ai' && currentPlayer === 2 && !levelComplete && !pvpWinner && !processing && flippedIndices.length === 0 && aiTargets.length === 0) {
                    const timer = setTimeout(() => performAiTurn(), 1000);
                    return () => clearTimeout(timer);
                 }
            }, [currentPlayer, gameMode, processing, levelComplete, pvpWinner, flippedIndices.length, aiTargets.length]);

            // AI Logic Hook 2
            React.useEffect(() => {
                if (gameMode !== 'ai' || currentPlayer !== 2 || aiTargets.length === 0) return;
                if (flippedIndices.length === 0) {
                    const timer = setTimeout(() => handleCardClick(aiTargets[0]), 400);
                    return () => clearTimeout(timer);
                } else if (flippedIndices.length === 1) {
                    if (flippedIndices[0] !== aiTargets[1]) {
                        const timer = setTimeout(() => {
                            handleCardClick(aiTargets[1]);
                            setAiTargets([]);
                        }, 800);
                        return () => clearTimeout(timer);
                    }
                }
            }, [aiTargets, flippedIndices, gameMode, currentPlayer]);

            React.useEffect(() => { if (gameMode && gameMode !== 'pvp_online') startLevel(); }, [level, gameMode]);

            React.useEffect(() => {
                if (gameMode === 'pvp_online' && roomId && db) {
                    const roomRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('rooms').doc(roomId);
                    const unsubscribe = roomRef.onSnapshot((doc) => {
                        if (doc.exists) {
                            const data = doc.data();
                            if (isHost && onlineStatus === 'waiting' && data.guestId) setOnlineStatus('playing');
                            if (data.status === 'playing') {
                                setCards(data.board || []); setFlippedIndices(data.flipped || []); setMatchedIndices(data.matched || []); setScores(data.scores || { host: 0, guest: 0 });
                                setCurrentPlayer(data.turn === data.hostId ? 1 : 2); setProcessing(data.processing || false);
                                
                                if ((data.matched || []).length === (data.board || []).length && (data.board || []).length > 0 && !hasPaid) {
                                    const s = data.scores;
                                    const winner = s.host > s.guest ? 1 : (s.guest > s.host ? 2 : 'draw');
                                    setPvPWinner(winner);
                                    setHasPaid(true); 

                                    let betAmount = 200;
                                    let newCoinBalance = coins;
                                    
                                    if (winner !== 'draw') {
                                        const amIHost = isHost;
                                        const iWon = (amIHost && winner === 1) || (!amIHost && winner === 2);
                                        
                                        if (iWon) newCoinBalance += betAmount;
                                        else newCoinBalance -= betAmount;
                                        
                                        setCoins(newCoinBalance);
                                        if (user && db) {
                                            const userRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('leaderboard').doc(user.uid);
                                            userRef.set({ coins: newCoinBalance }, { merge: true });
                                        }
                                    }
                                }
                            }
                        }
                    }, (error) => { console.error("Lỗi đồng bộ:", error); if (onlineStatus !== 'idle') alert("Mất kết nối!"); });
                    return () => unsubscribe();
                }
            }, [gameMode, roomId, isHost, onlineStatus, hasPaid, coins]);

            const startLevel = () => {
                setLevelComplete(false); setMatchedIndices([]); setFlippedIndices([]); setPvPWinner(null); setAiMemory({}); setHasPaid(false); setAiTargets([]);
                if (level === 1) { setCurrentPlayer(1); setScores({ 1: 0, 2: 0 }); }
                const shuffledData = [...allData].sort(() => Math.random() - 0.5);
                const pairCount = (gameMode === 'ai' || gameMode === 'pvp_online') ? 8 : 6;
                const selectedItems = shuffledData.slice(0, pairCount);
                let cardSet = [];
                selectedItems.forEach(item => { cardSet.push({ id: `word-${item.id}-${Math.random()}`, content: item.word, type: 'word', itemId: item.id }); cardSet.push({ id: `mean-${item.id}-${Math.random()}`, content: item.meaning, type: 'meaning', itemId: item.id }); });
                setCards(cardSet.sort(() => Math.random() - 0.5));
            };

            const createRoom = async () => {
                if (!user || !db) return alert("Vui lòng đăng nhập!");
                if (coins < 200) return alert("Bạn cần ít nhất 200 xu để cược!");
                try {
                    const newRoomId = Math.floor(100000 + Math.random() * 900000).toString();
                    const shuffledData = [...allData].sort(() => Math.random() - 0.5);
                    const selectedItems = shuffledData.slice(0, 8); 
                    let cardSet = [];
                    selectedItems.forEach(item => { cardSet.push({ id: `word-${item.id}-${Math.random()}`, content: item.word, type: 'word', itemId: item.id }); cardSet.push({ id: `mean-${item.id}-${Math.random()}`, content: item.meaning, type: 'meaning', itemId: item.id }); });
                    cardSet.sort(() => Math.random() - 0.5);
                    const roomRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('rooms').doc(newRoomId);
                    await roomRef.set({ hostId: user.uid, guestId: null, status: 'waiting', board: cardSet, flipped: [], matched: [], turn: user.uid, scores: { host: 0, guest: 0 }, processing: false, createdAt: new Date().toISOString() });
                    setRoomId(newRoomId); setIsHost(true); setOnlineStatus('waiting'); setHasPaid(false);
                } catch (error) { console.error("Lỗi tạo phòng:", error); alert("Lỗi tạo phòng. Hãy kiểm tra mạng."); }
            };

            const joinRoom = async () => {
                if (!user || !db) return alert("Vui lòng đăng nhập!");
                if (coins < 200) return alert("Bạn cần ít nhất 200 xu để cược!");
                if (!inputRoomId) return alert("Vui lòng nhập mã phòng!");
                try {
                    const roomRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('rooms').doc(inputRoomId);
                    const doc = await roomRef.get();
                    if (!doc.exists) return alert("Phòng không tồn tại!");
                    if (doc.data().hostId === user.uid) return alert("Bạn không thể tự vào phòng của chính mình!");
                    if (doc.data().status !== 'waiting') return alert("Phòng đang chơi hoặc đã đầy!");
                    await roomRef.update({ guestId: user.uid, status: 'playing' });
                    setRoomId(inputRoomId); setIsHost(false); setOnlineStatus('playing'); setHasPaid(false);
                } catch (error) { console.error("Lỗi vào phòng:", error); alert("Lỗi kết nối phòng."); }
            };

            if (!gameMode) {
                return (
                    <div className="flex flex-col items-center justify-center h-[500px] gap-6 animate-fadeIn">
                        <h2 className="text-2xl font-black text-indigo-900 mb-4">Chọn Chế Độ Chơi</h2>
                        <button onClick={() => setGameMode('solo')} className="w-64 p-6 bg-white border-2 border-indigo-100 hover:border-indigo-500 rounded-2xl shadow-lg hover:shadow-xl transition flex flex-col items-center gap-3 group"> <div className="w-16 h-16 bg-indigo-50 rounded-full flex items-center justify-center group-hover:bg-indigo-100 transition"><i className="fas fa-user text-3xl text-indigo-600"></i></div> <span className="font-bold text-lg text-slate-800">Luyện tập (1 người)</span> </button>
                        <button onClick={() => setGameMode('ai')} className="w-64 p-6 bg-white border-2 border-purple-100 hover:border-purple-500 rounded-2xl shadow-lg hover:shadow-xl transition flex flex-col items-center gap-3 group"> <div className="w-16 h-16 bg-purple-50 rounded-full flex items-center justify-center group-hover:bg-purple-100 transition"><i className="fas fa-robot text-3xl text-purple-600"></i></div> <span className="font-bold text-lg text-slate-800">Chơi với Máy (AI)</span> </button>
                        <button onClick={() => setGameMode('pvp_online')} className="w-64 p-6 bg-white border-2 border-orange-100 hover:border-orange-500 rounded-2xl shadow-lg hover:shadow-xl transition flex flex-col items-center gap-3 group"> <div className="w-16 h-16 bg-orange-50 rounded-full flex items-center justify-center group-hover:bg-orange-100 transition"><i className="fas fa-globe text-3xl text-orange-600"></i></div> <span className="font-bold text-lg text-slate-800">Online PvP (Cược 200)</span> </button>
                    </div>
                );
            }

            if (gameMode === 'pvp_online' && onlineStatus !== 'playing') {
                return (
                    <div className="flex flex-col items-center justify-center h-[500px] gap-6 animate-fadeIn">
                        <button onClick={() => { setGameMode(null); setOnlineStatus('idle'); }} className="absolute top-4 left-4 text-slate-400 hover:text-slate-600 font-bold"><i className="fas fa-arrow-left"></i> Menu</button>
                        {onlineStatus === 'waiting' ? (
                            <div className="text-center">
                                <div className="w-20 h-20 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse"> <i className="fas fa-wifi text-4xl text-orange-500"></i> </div>
                                <h3 className="text-xl font-bold text-slate-800 mb-2">Đang chờ đối thủ...</h3> 
                                <p className="text-slate-500 mb-4">Gửi mã này cho bạn bè:</p> 
                                <div className="text-4xl font-black text-indigo-600 bg-white border-2 border-indigo-100 px-6 py-3 rounded-xl tracking-widest shadow-sm mb-6">{roomId}</div> 
                                <p className="text-xs font-bold text-orange-600 mb-2"><i className="fas fa-coins"></i> Cược: 200 Xu</p>
                                <p className="text-xs text-slate-400">Đừng thoát màn hình này nhé.</p>
                            </div>
                        ) : (
                            <div className="space-y-4 w-full max-w-xs text-center">
                                <h2 className="text-2xl font-black text-indigo-900 mb-6">Online PvP Lobby</h2>
                                <p className="text-sm font-bold text-orange-600 bg-orange-50 py-2 rounded-lg mb-4"><i className="fas fa-coins"></i> Phí tham gia: 200 Xu</p>
                                <button onClick={createRoom} className="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold shadow-lg hover:bg-indigo-700 transition flex items-center justify-center gap-2"> <i className="fas fa-plus-circle"></i> Tạo Phòng Mới </button>
                                <div className="relative"> <div className="absolute inset-0 flex items-center"><div className="w-full border-t border-gray-200"></div></div> <div className="relative flex justify-center text-sm"><span className="px-2 bg-[#f0f4f8] text-gray-500">Hoặc vào phòng</span></div> </div>
                                <div className="flex gap-2"> <input type="text" className="flex-1 border-2 border-gray-200 rounded-xl px-4 py-2 focus:outline-none focus:border-indigo-500 font-bold text-center tracking-widest" placeholder="Nhập mã phòng" maxLength="6" value={inputRoomId} onChange={(e) => setInputRoomId(e.target.value)} /> <button onClick={joinRoom} className="bg-white border-2 border-indigo-100 text-indigo-600 px-4 py-2 rounded-xl font-bold hover:bg-indigo-50">Vào</button> </div>
                            </div>
                        )}
                    </div>
                );
            }

            const myTurn = (gameMode === 'pvp_online') ? ((isHost && currentPlayer === 1) || (!isHost && currentPlayer === 2)) : true;

            return (
                <div className="max-w-3xl mx-auto py-4 px-2 relative">
                    <div className="flex justify-between items-center mb-4">
                        <button onClick={() => { setGameMode(null); setOnlineStatus('idle'); }} className="text-slate-400 hover:text-slate-600 text-sm font-bold"><i className="fas fa-arrow-left"></i> Menu</button>
                        {gameMode === 'solo' ? (
                            <div className="flex gap-4 items-center"> <div className="text-xl font-black text-indigo-800">Level {level}</div> <div className="text-sm text-slate-500">Đã ghép: <span className="font-bold text-indigo-600">{matchedIndices.length / 2}</span> / {cards.length / 2}</div> </div>
                        ) : (
                            <div className="flex gap-4 sm:gap-8 items-center bg-white px-4 sm:px-6 py-2 rounded-full shadow-sm border border-slate-100">
                                <div className={`flex flex-col items-center px-4 py-1 rounded-lg transition-all ${currentPlayer === 1 ? 'bg-blue-50 border-b-2 border-blue-500' : 'opacity-50'}`}> <span className="text-xs font-bold text-blue-800">{gameMode === 'pvp_online' && !isHost ? 'Đối thủ' : 'Bạn (P1)'}</span> <span className="text-lg font-black text-blue-600">{scores[1]}</span> </div>
                                <div className="text-slate-300 font-bold text-xs">VS</div>
                                <div className={`flex flex-col items-center px-4 py-1 rounded-lg transition-all ${currentPlayer === 2 ? 'bg-red-50 border-b-2 border-red-500' : 'opacity-50'}`}> <span className="text-xs font-bold text-red-800">{gameMode === 'ai' ? 'Máy (AI)' : (gameMode === 'pvp_online' && !isHost ? 'Bạn (P2)' : 'Đối thủ')}</span> <span className="text-lg font-black text-red-600">{scores[2]}</span> </div>
                            </div>
                        )}
                    </div>

                    <div className="grid grid-cols-4 gap-2 sm:gap-4 max-w-lg mx-auto">
                        {cards.map((card, index) => {
                            const isFlipped = flippedIndices.includes(index); const isMatched = matchedIndices.includes(index);
                            if (isMatched) return <div key={card.id} className="aspect-square opacity-0 transition-opacity duration-500"></div>;
                            return (
                                <div key={card.id} onClick={() => handleCardClick(index)} className={`relative aspect-square cursor-pointer perspective-1000 group ${!myTurn && gameMode === 'pvp_online' ? 'cursor-not-allowed opacity-80' : ''}`}>
                                    <div className={`w-full h-full transition-all duration-300 transform-style-3d relative shadow-sm rounded-lg ${isFlipped ? 'rotate-y-180' : ''}`}>
                                        <div className={`absolute inset-0 backface-hidden border-2 rounded-lg flex items-center justify-center transition-colors shadow-inner ${card.type === 'word' ? 'bg-blue-50 border-blue-200' : 'bg-red-50 border-red-200'}`}> {card.type === 'word' ? ( <div className="text-center"> <i className="fas fa-flag-usa text-3xl text-blue-300 mb-1 opacity-50"></i> <span className="block text-xs font-black text-blue-400 mt-1">EN</span> </div> ) : ( <div className="text-center"> <i className="fas fa-star text-3xl text-red-300 mb-1 opacity-50"></i> <span className="block text-xs font-black text-red-400 mt-1">VN</span> </div> )} </div>
                                        <div className="absolute inset-0 backface-hidden rotate-y-180 bg-white border-2 border-indigo-500 rounded-lg flex flex-col items-center justify-center p-2 text-center shadow-lg"> <span className="text-[10px] font-bold text-indigo-400 uppercase mb-1">{card.type === 'word' ? 'EN' : 'VN'}</span> <p className={`${card.content.length > 20 ? 'text-xs' : 'text-sm'} font-bold text-slate-800`}>{card.content}</p> </div>
                                    </div>
                                </div>
                            );
                        })}
                    </div>

                    {matchedItem && (
                       <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fadeIn">
                           <div className="bg-white rounded-xl shadow-2xl p-6 max-w-sm w-full border-2 border-indigo-100 relative text-center"> <div className="inline-block p-3 rounded-full bg-green-100 text-green-600 mb-3 text-2xl animate-bounce"><i className="fas fa-check"></i></div> <h3 className="text-2xl font-black text-indigo-900 mb-1">{matchedItem.word}</h3> <div className="flex justify-center gap-2 mb-3"><SpeakerButton text={matchedItem.word} lang="US" /><SpeakerButton text={matchedItem.word} lang="UK" /></div> <p className="text-slate-500 font-mono text-sm mb-3">{matchedItem.ipa}</p> <p className="text-lg font-bold text-yellow-600 mb-4">{matchedItem.meaning}</p> <div className="bg-slate-50 p-3 rounded-lg text-sm text-slate-600 italic mb-5 border border-slate-100">"{matchedItem.example}"</div> <button onClick={() => setMatchedItem(null)} className="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-3 rounded-lg font-bold shadow-lg transition transform hover:scale-105">Tiếp tục</button> </div>
                       </div>
                    )}

                    {levelComplete && gameMode === 'solo' && (
                        <div className="absolute inset-0 z-10 bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center rounded-xl animate-fadeIn"> <i className="fas fa-crown text-6xl text-yellow-400 mb-4 drop-shadow-md"></i> <h2 className="text-3xl font-black text-indigo-900 mb-2">Hoàn Thành!</h2> <p className="text-slate-600 mb-6">Bạn đã vượt qua Level {level}</p> <button onClick={() => setLevel(l => l + 1)} className="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-full font-bold shadow-lg transform hover:scale-105 transition">Màn Tiếp Theo <i className="fas fa-arrow-right ml-2"></i></button> </div>
                    )}

                    {pvpWinner && (
                        <div className="absolute inset-0 z-10 bg-white/90 backdrop-blur-md flex flex-col items-center justify-center rounded-xl animate-fadeIn p-6 text-center">
                            {pvpWinner === 'draw' ? ( <><i className="fas fa-handshake text-6xl text-gray-400 mb-4"></i><h2 className="text-3xl font-black text-slate-800 mb-2">Hòa Nhau!</h2></> ) : ( <> <i className="fas fa-trophy text-6xl text-yellow-400 mb-4 drop-shadow-lg animate-bounce"></i> <h2 className={`text-4xl font-black mb-2 ${pvpWinner === 1 ? 'text-blue-600' : 'text-red-600'}`}> {gameMode === 'pvp_online' ? (isHost && pvpWinner === 1) || (!isHost && pvpWinner === 2) ? 'Bạn Thắng!' : 'Bạn Thua Rồi!' : (pvpWinner === 1 ? 'Bạn Thắng!' : 'Máy Thắng!')} </h2> <p className="text-xl font-bold text-slate-500 mb-4">Điểm số: {scores[pvpWinner]}</p> 
                            {gameMode === 'pvp_online' && (
                                <div className={`px-4 py-2 rounded-lg font-bold text-lg mb-4 inline-block ${(isHost && pvpWinner === 1) || (!isHost && pvpWinner === 2) ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`}>
                                    {(isHost && pvpWinner === 1) || (!isHost && pvpWinner === 2) ? '+200 Xu' : '-200 Xu'}
                                </div>
                            )}
                            </> )} <button onClick={() => { setGameMode(null); setOnlineStatus('idle'); }} className="bg-slate-800 hover:bg-slate-900 text-white px-8 py-3 rounded-full font-bold shadow-lg transition">Về Menu Chính</button>
                        </div>
                    )}
                </div>
            );
        };

        function App() {
            const [view, setView] = React.useState('list'); 
            const [selectedTopic, setSelectedTopic] = React.useState('All');
            const [searchTerm, setSearchTerm] = React.useState('');
            const [learnedWords, setLearnedWords] = React.useState(new Set());
            const [coins, setCoins] = React.useState(0);
            const [showDetails, setShowDetails] = React.useState(null); 
            const [highlightedId, setHighlightedId] = React.useState(null);
            const [user, setUser] = React.useState(null);
            const [showLeaderboard, setShowLeaderboard] = React.useState(false);

            React.useEffect(() => {
                if (!auth) return;
                const unsubscribe = auth.onAuthStateChanged((u) => {
                    if (u) { setUser(u); } 
                    else { auth.signInAnonymously().catch(e => console.error("Anon Auth Error", e)); }
                });
                return () => unsubscribe();
            }, []);

            const loginGoogle = async () => {
                try {
                    await auth.signInWithPopup(googleProvider);
                } catch (error) {
                    console.error("Login failed", error);
                    alert("Lỗi đăng nhập Google: " + error.message);
                }
            };

            const logout = async () => {
                await auth.signOut();
            };

            React.useEffect(() => {
                const saved = localStorage.getItem('toeic_learned_full_v2');
                if (saved) setLearnedWords(new Set(JSON.parse(saved)));
                const savedCoins = localStorage.getItem('toeic_user_coins');
                if (savedCoins) setCoins(parseInt(savedCoins, 10));
            }, []);

            React.useEffect(() => { localStorage.setItem('toeic_learned_full_v2', JSON.stringify([...learnedWords])); }, [learnedWords]);

            React.useEffect(() => {
                localStorage.setItem('toeic_user_coins', coins.toString());
                if (user && db) {
                    const userRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('leaderboard').doc(user.uid);
                    userRef.set({ coins: coins }, { merge: true });
                }
            }, [coins, user]);

            const topics = ['All', ...new Set(toeicData.map(item => item.topic))];
            const toggleLearned = (id) => { setLearnedWords(prev => { const newSet = new Set(prev); if (newSet.has(id)) newSet.delete(id); else newSet.add(id); return newSet; }); };
            const toggleDetails = (id) => setShowDetails(prev => prev === id ? null : id);
            const jumpToWord = (wordText) => {
                const target = toeicData.find(w => w.word.toLowerCase() === wordText.toLowerCase());
                if (target) {
                    if (selectedTopic !== 'All' && target.topic !== selectedTopic) setSelectedTopic('All');
                    setSearchTerm(''); if (view !== 'list') setView('list'); setShowDetails(target.id); setHighlightedId(target.id);
                    setTimeout(() => { const el = document.getElementById(`word-${target.id}`); if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' }); }, 150);
                    setTimeout(() => setHighlightedId(null), 2500);
                }
            };
            const filteredData = toeicData.filter(item => {
                const matchTopic = selectedTopic === 'All' || item.topic === selectedTopic;
                const matchSearch = item.word.toLowerCase().includes(searchTerm.toLowerCase()) || item.meaning.toLowerCase().includes(searchTerm.toLowerCase());
                return matchTopic && matchSearch;
            });
            const speakWord = (text) => { if ('speechSynthesis' in window) { window.speechSynthesis.cancel(); const u = new SpeechSynthesisUtterance(text); u.lang = 'en-US'; window.speechSynthesis.speak(u); } };

            return (
                <div className="min-h-screen flex flex-col max-w-7xl mx-auto shadow-2xl bg-white rounded-xl overflow-hidden my-2 border border-slate-200">
                    <header className="bg-gradient-to-br from-indigo-900 via-blue-900 to-indigo-900 text-white p-4 shadow-lg sticky top-0 z-50">
                        <div className="flex flex-col md:flex-row justify-between items-center gap-4">
                            <div><h1 className="text-xl font-black tracking-tight flex items-center gap-2"><i className="fas fa-graduation-cap text-yellow-400"></i> TOEIC Liam</h1><p className="text-indigo-200 text-xs mt-1">Học từ vựng & Kiếm Xu</p></div>
                            <div className="flex items-center gap-3">
                                {user && !user.isAnonymous ? (
                                    <div className="flex items-center gap-2 bg-white/10 px-3 py-1.5 rounded-full border border-white/20">
                                        <img src={user.photoURL} alt="User" className="w-6 h-6 rounded-full border border-white" />
                                        <span className="text-xs font-bold truncate max-w-[80px]">{user.displayName}</span>
                                        <button onClick={logout} className="text-red-300 hover:text-red-100 ml-1"><i className="fas fa-sign-out-alt"></i></button>
                                    </div>
                                ) : (
                                    <button onClick={loginGoogle} className="bg-white text-indigo-900 px-3 py-1.5 rounded-full font-bold shadow-md flex items-center gap-2 text-sm hover:bg-gray-100 transition">
                                        <i className="fab fa-google text-red-500"></i> <span>Đăng nhập</span>
                                    </button>
                                )}
                                <button onClick={() => setShowLeaderboard(true)} className="bg-yellow-400 hover:bg-yellow-300 text-indigo-900 px-3 py-1.5 rounded-full font-bold shadow-md flex items-center gap-2 text-sm transition"><i className="fas fa-trophy"></i><span>BXH</span></button>
                                <div className="bg-white/10 px-3 py-1.5 rounded-full font-bold flex items-center gap-2 border border-white/20"><i className="fas fa-coins text-yellow-400"></i> <span>{coins}</span></div>
                            </div>
                        </div>
                        <div className="mt-4 flex bg-white/10 p-1 rounded-lg backdrop-blur-sm overflow-x-auto">
                            {[ {id: 'list', icon: 'fa-list', label: 'Từ vựng'}, {id: 'flashcard', icon: 'fa-layer-group', label: 'Flashcard'}, {id: 'quiz', icon: 'fa-question-circle', label: 'Quiz'}, {id: 'game', icon: 'fa-gamepad', label: 'Lật Hình'} ].map(tab => (
                                <button key={tab.id} onClick={() => setView(tab.id)} className={`flex-1 px-4 py-2 rounded-md transition-all text-sm font-bold flex items-center justify-center gap-2 whitespace-nowrap ${view === tab.id ? 'bg-white text-indigo-900 shadow-lg' : 'text-indigo-200 hover:text-white hover:bg-white/10'}`}><i className={`fas ${tab.icon}`}></i> {tab.label}</button>
                            ))}
                        </div>
                        {view === 'list' && (
                            <div className="mt-3 flex gap-2">
                                <select className="bg-indigo-800/50 border border-indigo-700 text-white px-3 py-2 rounded text-sm focus:outline-none" value={selectedTopic} onChange={(e) => setSelectedTopic(e.target.value)} >{topics.map(t => <option key={t} value={t} className="text-gray-900">{t}</option>)}</select>
                                <input type="text" placeholder="Tìm kiếm..." className="flex-grow px-3 py-2 rounded text-slate-900 bg-white text-sm focus:outline-none" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
                            </div>
                        )}
                    </header>
                    <main className="flex-grow p-4 bg-slate-50 relative overflow-y-auto h-[600px] scroll-smooth">
                        {view === 'list' && <WordListView data={filteredData} learnedWords={learnedWords} toggleLearned={toggleLearned} showDetails={showDetails} toggleDetails={toggleDetails} highlightedId={highlightedId} />}
                        {view === 'flashcard' && <FlashcardView data={filteredData} learnedWords={learnedWords} toggleLearned={toggleLearned} />}
                        {view === 'quiz' && <QuizView allData={toeicData} setCoins={setCoins} user={user} speakWord={speakWord} />}
                        {view === 'game' && <MemoryGameView allData={toeicData} setCoins={setCoins} user={user} coins={coins} />}
                    </main>
                    <LeaderboardModal isOpen={showLeaderboard} onClose={() => setShowLeaderboard(false)} user={user} coins={coins} />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

